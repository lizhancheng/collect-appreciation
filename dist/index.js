"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){function e(e){e=e||t(a);for(var i="",n=Math.random()>.66?1:2,r=0;r<n;r++)i+=t(o);return e+i}function t(e){return e=e||[],e[i(0,e.length-1)]}function i(e,t){return Math.round(Math.random()*(t-e))+e}var n={random:e},a=["赵","钱","孙","李","周","吴","郑","王","冯","陈","褚","卫","蒋","沈","韩","杨","朱","秦","尤","许","何","吕","施","张","孔","曹","严","华","金","魏","陶","姜","戚","谢","邹","喻","柏","水","窦","章","云","苏","潘","葛","奚","范","彭","郎","鲁","韦","昌","马","苗","凤","花","方","俞","任","袁","柳","鲍","史","唐","费","廉","岑","薛","雷","贺","倪","汤","滕","殷","罗","毕","郝","邬","安","常","乐","于","时","傅","皮","卞","齐","康","伍","余","元","卜","顾","孟","平","黄","和","穆","萧","尹","姚","邵","湛","汪","祁","毛","禹","狄","米","贝","明","臧","计","伏","成","戴","谈","宋","茅","庞","熊","纪","舒","屈","项","祝","董","粱","杜","阮","蓝","闵","席","季","麻","强","贾","路","娄","江","童","颜","郭","梅","盛","林","刁","钟","徐","邱","骆","高","夏","蔡","田","樊","胡","凌","霍","虞","万","支","柯","卢","莫","经","房","裘","缪","干","解","应","宗","丁","邓","郁","单","杭","洪","包","左","石","崔","吉","钮","龚","程","嵇","邢","裴","陆","荣","翁","荀","甄","家","封","靳","井","段","巫","乌","焦","巴","谷","车","侯","班","秋","伊","宫","宁","仇","甘","厉","武","符","刘","景","詹","龙","叶","郜","黎","薄","白","蒲","邰","赖","卓","蔺","屠","蒙","池","乔","翟","谭","姬","申","冉","雍","桂","牛","燕","农","温","庄","晏","柴","瞿","阎","习","艾","鱼","容","向","古","易","廖","步","都","耿","满","匡","文","寇","巩","聂","晁","敖","冷","辛","那","简","饶","曾","沙","鞠","关","查","游","权","楚","岳","言","况","商","佘","年","佟","司马","上官","欧阳","夏侯","诸葛","闻人","东方","赫连","皇甫","尉迟","公孙","轩辕","令狐","钟离","宇文","长孙","慕容","司徒","端木","拓拔","百里","东郭","呼延","西门","南宫"],o="贵福生龙元全国胜学祥才发武新利清飞彬富顺信子杰涛昌成康星光天达安岩中茂进林有坚和彪博绍功松善厚庆磊民友裕河哲江超浩亮政谦亨奇固之轮翰朗伯宏言若鸣朋斌梁栋维启克伦翔旭鹏月莺媛艳瑞凡佳嘉琼勤珍贞莉桂娣叶璧璐娅琦晶妍茜秋珊莎锦黛青倩婷姣婉娴瑾颖露瑶怡婵雁蓓".split("");"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=n:"function"==typeof define&&define.amd?define("ChineseName",[],function(){return n}):"function"==typeof define&&define.cmd&&define(function(){return n}),this.ChineseName=n}).call(window),function(){var e=function(){var e=(document.body,document.getElementById("cas")),t=e.width+"px",i=e.height+"px";!function(){function e(){var e=document.body,n=document.createElement("div");return n.className="ui-mask",Object.assign(n.style,{width:t,height:i}),{show:function(){e.appendChild(n)},hide:function(){e.removeChild(n)}}}var n=void 0;({get:function(){return n||(n=e()),n}})}();e.addEventListener("touchstart",function(e){col.reinit(),col.next(e.touches[0].pageY-e.target.offsetTop)})};window.addEventListener("DOMContentLoaded",e,!1)}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();!function(e,t){function i(){if(!arguments.length)return null;var e=void 0;e=Array.prototype.slice.call(arguments).map(function(e){return new n(e)});var t=[].concat(_toConsumableArray(Object.keys(e[0])));return t=t.map(function(t){return e.reduce(function(e,i){return e[t]*i[t]})}),t[0]/t[1]}var n=function(){function e(t){_classCallCheck(this,e),this.value=t,this.toInteger()}return _createClass(e,[{key:"isInteger",value:function(e){return(0,Math.floor)(e)===e}},{key:"toInteger",value:function(){var e=this.value;if((0,this.isInteger)(e))return this.times=1,!0;e=e.toLocaleString();var t=e.split("."),i=t[1].length;this.times=Math.pow(10,i),this.value*=this.times}}]),e}(),a=function(){function e(){_classCallCheck(this,e),this.cas=document.getElementById("cas"),this.ctx=this.cas.getContext("2d")}return _createClass(e,[{key:"init",value:function(e){this.cas.classList.remove("hidden"),this.loadImage(e)}},{key:"onLoad",value:function(e){URL.revokeObjectURL(e.src);var t=this.cas,i=this.ctx;this.image=this.image||e;var n=this.image.width,a=this.image.height,o=(t.width,540/a);this.img={width:o*n,height:o*a,scale:o},t.width=this.img.width,t.height=this.img.height,i.drawImage(this.image,0,0,this.img.width,540)}},{key:"loadImage",value:function(e){var t=this.onLoad,i=new Image;i.onload=t.bind(this,i),i.src=e}},{key:"next",value:function(){this.copyImage.apply(this,arguments),this.fillDialog(),this.fillAppreciate()}},{key:"copyImage",value:function(e,t){var i=(this.cas,this.ctx);this.dialog={startY:e||239,endY:t||this.image.height};var n=i.getImageData(0,this.dialog.startY,this.img.width,this.dialog.endY);i.putImageData(n,0,this.dialog.endY)}},{key:"fillDialog",value:function(){var e=(this.cas,this.ctx),t=this.img,n=this.dialog,a=n.startY,o=(n.endY,t.height-a),r=t.width,c=[i(r,.17),a,i(r,.8),o];this.crd=[].concat(c),e.clearRect(0,a,r,o),e.fillStyle="#f9f7f9",e.fillRect(0,a,r,o),e.fillStyle="#efedef",e.beginPath(),e.moveTo(c[0]+10,c[1]),e.lineTo(c[0]+20,c[1]),e.lineTo(c[0]+15,c[1]-5),e.closePath(),e.fill(),e.fillStyle="#efedef",e.fillRect.apply(e,c)}},{key:"fillAppreciate",value:function(){var e=new Image,t=this.ctx,i=this.crd,n=this.img.scale;n=n>.43?.43:n,e.onload=function(){t.drawImage(e,i[0]+8,i[1]+8,e.width*n,e.height*n)},e.src="resources/images/heart.png",t.font="10px Microsoft YaHei",t.fillStyle="#637b9d",this.fillText()}},{key:"fillText",value:function(){for(var e=this.ctx,t=(this.crd,Math.random),i=Math.floor,n=170+i(30*t()),a=this.nameDeploy(n),o=0;o<n;o++)e.fillText(a[o].name,a[o].x,a[o].y)}},{key:"nameDeploy",value:function(e){for(var t=this.ctx,i=this.crd,n=[],a=void 0,o=1,r=0;r<e;r++){if(a=Object.create({}),a.name=ChineseName.random()+", ",a.length=t.measureText(a.name).width,n[r-1]){var c=n[r-1];a.x=c.x+c.length,c.minus&&(a.x-=c.minus)}else n[r-1]||(a.x=i[0]+25);a.x>i[2]&&(this.explode(a,n[r-1]),a.x=i[0]+8,o++),a.y=i[1]+18*o,n.push(a)}return n}},{key:"explode",value:function(e,t){for(var i=this.ctx,n=this.crd,a=-1;t.x+i.measureText(e.name.slice(0,a)).width>n[2];)--a;e.name.slice(a,a+1).match(/,/g)&&a++,t.name+=e.name.slice(0,a);var o=e.name.slice(a);o||(e.name=o)}},{key:"reinit",value:function(){this.onLoad(this.image)}}]),e}();e.URL=e.URL||e.webkitURL||e.mozURL,e.col=new a,function(){var e=t("#userfile");e.addEventListener("change",function(t){var i=t.target.files;Array.prototype.forEach.call(i,function(e){return e.type.match(/^image/)&&col.init(URL.createObjectURL(e))}),e.parentNode.classList.add("hidden")},!1)}()}(window,document.querySelector.bind(document));
//# sourceMappingURL=index.js.map
